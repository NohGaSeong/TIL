# 2.운영 서버 환경의 구성

1장에서 나왔단 운영 서버 관리의 세 단계 중 첫 번째인 '환경 구성' 에 대해 배워볼게요.<br>
운영 서버에서 자주 사용되는 아키텍처부터 알아보면서 어떤 구성 요소들이 운영 서버 아키텍처를 이루는지 알아보고<br>
작성한 소스코드를 실행할 수 있는 서버 인스턴스를 생성하는 것부터 서버 내부 환경을 구성하는 방법도 배울거에요.

실습 : 각 명령어가 어떤 작동을 하는지 특정 상황에서는 왜 sudo를 이용해 root 권한을 사용하는 것인지를 설명해요. 무작정 따라치지 말고 이해해보도록해요🙃

## 2.1 운영 서버 아키텍처의 이해
자주 이용되는 운영 서버 아키텍처들을 알아보면서 운영 서버가 어떻게 구성돼 있는지 알아보자
### 2.1.1 단일 서버
가장 기본적인 구성. 요청을 보내는 클라이언트, 요청을 처리하는 서버가 한 대 있어요. 여기서 얘기하는 클라이언트는 휴대폰 앱이나 웹 브라우저를 의미해요.
서버 내에서는 에플리케이션 코드와 데이터베이스가 실행되고있고요. 단순한 구성인만큼 환경을 구축하기 쉬워 테스트 서버나 간단한 애플리케이션을 서비스할때 많이 사용돼요.
그리고 데이터 베이스와 애플리케이션이 같은서버에서 실행되고 있기에 별도의 네트워크 설정을 할 필요 없이 로컬 호스트를 대상으로 하면돼요. 하지만 단점도 여러가지 있겠죠?

- 전체 서비스에 장애가 생길 확률이 높아요.
- 서버 자원을 효율적으로 사용하기 어려워요.
- 보안성이 떨어져요.
- 서버의 수를 여럳로 늘려서 자원을 확장하는 스케일 아웃이 힘들어요.

![1번](https://user-images.githubusercontent.com/82383294/141995425-fe9b496a-c658-4504-9b5e-f58423483489.png)

### 2.1.2 애플리케이션/데이터베이스 서버 분리
단일 서버 구성에서 DB를 별도의 서버로 분리한 구성이에요. 애플리케이션과 DB가 다른 자원을 사용하기 때문에 단일 서버의 단점들이 커버돼요. 다만 두 대의 서버를 관리하기 때문에 구성이 조금 더 복잡해지고 서버 사이의 지연 시간과 네트워크 보안을 고려해야해요. 그리고 클라이언트에서는 하나의 서버를 바라보고 있기 때문에 서버 자원 확장을 위해 서버의 수를 늘리는 스케일 아웃은 여전히 힘들어요.

![2번](https://user-images.githubusercontent.com/82383294/141995399-e49450e0-4bf3-49b2-b914-bfa0ab51276e.png)

### 2.1.3 서버 단위의 로드 밸런스
클라이언트가 애플리케이션을 실해앟는 서버와 직접 통신하는 대신 로드 밸런서라는 서버와 통신하고 그 뒤에 여러 대의 애플리케이션 서버를 두는 방식이에요. 

클라이언트 -><- 로드 밸런서 -><- 서버 <br>
이런식으로 클라이언트는 로드밸런서랑만 통신을 해요. 로드 밸런서가 서버와 클라이언트 중간에 있는 징검다리? 역할을 해줘요.

![3번](https://user-images.githubusercontent.com/82383294/141995418-1d21bd69-1085-49f1-99d3-7a5e9c762d47.png)

### 2.1.4 서버 내 앱 단위의 로드 밸런서
여러 서버에게 요청을 분산하는 서버 단위의 로드 밸런서 외에도 여러 애플리케이션 프로세스들에 요청을 분산시키는 앱 단위의 로드 밸런서가 추가됐어요. 애플리케이션 서버 안에서 똑같은 애플리케이션을 여러 프로세스로 만들어 실행해 놓고 외부에서 들어온 요청을 프로세스 중 하나로 보내주는 역할을 하는 방식이에요. <br>
이처럼 구성하면 하나의 서버에 여러 개의 프로세스를 실행해 하나의 서버에서 여러 개의 요청을 동시에 처리할 수 있으며 서버 자원을 최대한으로 사용할 수 있는 만큼의 프로세스를 실행해 서버 자원도 더욱 효율적으로 사용할 수 있어요.

![4번](https://user-images.githubusercontent.com/82383294/141995423-7fd8d8b7-d3b1-4b56-8f5c-cf938832f3e2.png)


## 2.2 AWS EC2를 이용한 서버 인스턴스 생성과 관리
EC2 = 우리가 원하는 대로 돈 내고 사용하는 가상 서버. 대부분의 OS 지원. 사용 목적에 맞는 수십 가지 사양들을 제공.

### 2.2.2 EC2를 생성하려면 꼭 알아야하는 개념
1. AMI(Amazon Machine Image)
2. 보안 그룹(Security Group)
3. 키 페어(Key pair)

#### AMI
EC2 인스턴스의 기반이 되는 이미지에요. 윈도우 CD나 ISO파일을 만드는 것과 같은 원리에요. 아마존에서 기본적으로 유명한 서버 OS들도 많이 제공하고 개개인이 직접 생성해서 다른 사람들과 공유도 가능해요. 

#### 보안 그룹
보안을 위해 IP와 포트 번호를 이용해 정의해두는 서버 접속 규칙. 특정 IP와 포트에 대해서만 서버에 접속을 허용하거나 반대로 특정 IP만 금지할 수도 있다. 정의된 규칙들은 여러 서버에 적용할 수 있다.

#### 키페어
서버에 접속하기 위한 열쇠

## 2.3 실습
실습은 따로 md 파일 만들어서 정리할 예정

## 2.4 웹 서버와 웹 애플리케이션 서버
서버 소프트웨어는 크게 웹서버와 웹 애플리케이션 서버로 구분돼요.

### 2.4.1 웹 서버
웹 서버는 클라이언트에서 HTTP 프로토콜로 요청을 받고 정적인 파일들을 응답으로 전설해요. 여기서 정적인 파일밖에 제공하지 못한다는 것은HTML, 이미지, CSS, JS 파일과 같은 정적인 파일의 내용을 그대로 응답으로 줄 수는 있지만 애플리케이션 코드를 실행해 그 결과를 줄 수는 없다는 뜻이에요.<br>
로그인, DB 접속 등 서버에서 코드를 실행할 필요가 있는 애플리케이션은 웹 서버만으로는 실행할 수 없어요. 

### 2.4.2 웹 애플리케이션 서버
웹 서버와 다르게 클라이언트의 요청에 대해 코드 실행을 통해 동적인 응답을 만들어주는 역할을 한다. + 배포한 코드를 프로세스로 실행시키고, 해당 프로세스에 클라이언트의 요청을 넘겨주는 역할을 하기도해요. 단순히 프로세스의 실행뿐만 아니라 서버 자원을 최적으로 사용하기 위해 프로세스의 수나 프로세스의 메모리를 조절하기도해요.

소스코드를 실행하고 관리하는 소프트웨어다 보니 제품마다 지원하는 언어가 달라요. 따라서 애플리케이션의 언어에 맞는 웹 애플리케이션 서버를 선택해야해요.

### 2.4.3 웹 서버와 웹 애플리케이션 서버의 사용
웹서버 , 웹 애플리케이션 서버 => 보통 함께 사용. 한 서버에서 여러 종류의 애플리케이션을 서비스하는 경우 웹 서버가 정적 파일을 처리하는 역할이나 여러 웹 애플리케이션 서버로 라우팅하는 역할을 할 수 있다.

이제 예를 들자면 한 서버내에서 a 랑 b 라는 사이트를 서비스하는데 웹서버에서는 클라이언트에서 요청한 도메인 주소를 분석해 적절한 애플리케이션 서버로 전달해 줄 수 있고 이미지나 CSS같은 정적인 데이터는 바로 웹 서버에서 응답해주면돼요.

언어 등 필요한 기능과 상황에 맞게 웹 서버와 웹 애플리케이션 서버 제품을 선택하고 사용하면돼요.

### 2.4.4 클라이언트의 요청 이동 경로

1. 클라이언트에서는 네트워크과 ISP등을 거쳐 서버 인스턴스로 네트워크 패킷을 보내요.
2. 하드웨어인 서버 인스턴스에서는 해당 패킷을 읽어와 인스턴스에 설치된 서버 OS에 패킷을 넘겨요.
3. 서버 OS는 해당 패킷을 읽고 패킷에 적힌 포트를 리스닝하고 있는 웹 서버 프로세스에 요청 내용을 전달한다.
4. 웹 서버에서는 해당 HTTP 요청을 분서개서 적절한 웹 애플리케이션 서버에 전달한다.
5. 웹 애플리케이션 서버에서는 애플리케이션 코드를 실행하고 있는 애플리케이션 프로세스에 HTTP 요청의 내용을 파라미터를 전달해서 실행한 뒤 그 코드의 결괏값을 다시 웹 서버에 전달한다. 
6. 그 뒤로는 앞서 진행했던 단계의 반대 방향으로 클라이언트에게 응답이 전달된다.

## 11-16 : 2장 실습하고 md 파일로 정리해서 업로드
